---
name: req-to-testcase
description: 요구사항을 전달받으면 비즈니스 정책·규칙 추출, 검증 규칙 분류, 레이어별 책임 분리, 테스트 케이스 도출까지 체계적으로 수행하는 스킬. 요구사항 분석, 테스트 케이스 추출, 규칙 분류, 레이어 설계, API 명세 정리 등의 요청이 있을 때 반드시 이 스킬을 사용한다.
---

# Requirement Analysis Skill

요구사항을 입력받아 아래 4단계를 순서대로 수행하고, 각 단계의 결과를 표 형태로 출력한다.

```
Step 1. 비즈니스 정책·규칙 추출
Step 2. 검증 규칙 분류
Step 3. 레이어별 책임 분리
Step 4. 테스트 케이스 도출
```

각 단계를 수행하기 전에 `references/definitions.md`를 읽어 용어 정의와 분류 기준을 확인한다.

---

## Step 1. 비즈니스 정책·규칙 추출

요구사항에서 비즈니스 정책(Why)과 비즈니스 규칙(What)을 식별한다.

### 분류 기준

- **비즈니스 정책**: 서비스의 방향성·원칙을 선언한 것. "우리 서비스는 ~해야 한다"
- **비즈니스 규칙**: 정책을 실현하기 위한 구체적 조건. 주로 다른 필드나 DB 등 외부 상태와의 비교가 필요

### 출력 형식

| 비즈니스 정책 (Why) | 비즈니스 규칙 (What) | 해당 기능 |
|---|---|---|
| 회원 고유성 | 이미 가입된 로그인 ID로는 가입 불가 | 회원가입 |

### 판단 보조 질문

- "이 규칙은 왜 존재하는가?" → 답이 서비스 정책이면 비즈니스 규칙
- "이 필드 하나만 보고 판단 가능한가?" → Yes면 검증 규칙 가능성 높음 (Step 2로)
- "다른 서비스에 그대로 가져가도 성립하는가?" → Yes면 검증 규칙

---

## Step 2. 검증 규칙 분류

입력값의 포맷·형식을 검증하는 규칙을 별도로 분류한다.

### 분류 기준

- **검증 규칙(Validation Rule)**: 단일 필드만 보고 통과 여부를 판단할 수 있고, 도메인 지식 없이 데이터만으로 판단 가능한 규칙
- 길이 제한, 허용 문자, 형식(포맷) 등이 해당

### 출력 형식

| 필드 | 검증 규칙 | 적용 기능 |
|---|---|---|
| 비밀번호 | 8~16자 | 회원가입, 비밀번호 수정 |

### 주의사항

- 원문에 명시되지 않은 규칙을 임의로 추가한 경우, 해당 규칙에 "(원문 미명시, 정의 필요)" 표기
- 검증 규칙의 배경이 보안 정책이더라도 규칙 자체의 성격이 포맷 검증이면 검증 규칙으로 분류

---

## Step 3. 레이어별 책임 분리

Step 1, 2에서 도출된 규칙을 기능별 > 레이어별로 배치한다.

### 기본 레이어 구조

사용자가 레이어 구조를 명시하지 않으면 아래 기본값을 사용하되, 먼저 레이어 구조를 확인한다.

| 레이어 | 책임 |
|---|---|
| **Controller** | 요청/응답 처리, 입력값 포맷 검증 (검증 규칙), 헤더 파싱 |
| **Service** | 비즈니스 흐름 조율, 외부 상태와의 비교가 필요한 비즈니스 규칙 (DB 조회, 암호화 등) |
| **Domain** | 엔티티 자체의 규칙, 자기 상태만으로 판단 가능한 비즈니스 규칙 |

### 배치 판단 기준

- 단일 필드 포맷 검증 → Controller
- DB 조회, 외부 모듈 의존 필요 → Service
- 엔티티가 자기 필드만으로 판단 가능 → Domain
- **판단의 주체**와 **데이터 제공자**가 다를 수 있음. 규칙의 책임은 판단을 내리는 레이어에 둔다.

### 출력 형식

기능별로 분리하여 출력한다.

```
## {기능명}

| 레이어 | 규칙 |
|---|---|
| Controller | ... |
| Service | ... |
| Domain | ... |
```

---

## Step 4. 테스트 케이스 도출

Step 3의 결과를 기반으로, 기능별 > 레이어별로 테스트 케이스를 도출한다.

### 테스트 케이스 ID 규칙

형식: `TC-{기능약어}-{레이어약어}-{번호}`

예시:
- `TC-REG-C-001` : 회원가입(REG) Controller(C) 1번
- `TC-INF-S-002` : 내 정보 조회(INF) Service(S) 2번
- `TC-PWD-D-001` : 비밀번호 수정(PWD) Domain(D) 1번

기능 약어는 요구사항에 맞게 정의하되, 3~4자 영문 대문자로 통일한다.

### 케이스 도출 원칙

1. **성공 케이스**: 중간값 성공 + 경계값 성공을 모두 포함
2. **실패 케이스**: 경계값 실패 + 유형별 실패 (허용되지 않은 문자, 누락 등)
3. **경계값 테스트**: 범위가 있는 규칙은 반드시 경계값(최솟값, 최댓값)의 성공/실패를 모두 포함

| 범위 조건 예시 | 경계값 실패 | 경계값 성공 | 중간값 성공 |
|---|---|---|---|
| 8~16자 | 7자, 17자 | 8자, 16자 | 12자 |

4. **필수 필드 누락**: 필수 필드가 있으면 각 필드별 누락 케이스 추가
5. **엣지 케이스**: 도메인 특성에 따라 추가 (예: 이름 1자일 때 마스킹)

### 출력 형식

기능별 > 레이어별 계층으로 출력한다.

```
## {기능명}

### Controller

| TC ID | 테스트 케이스 | 예상 결과 |
|---|---|---|
| TC-REG-C-001 | 모든 필드가 유효한 중간값으로 요청 | 성공 |

### Service

| TC ID | 테스트 케이스 | 예상 결과 |
|---|---|---|
| TC-REG-S-001 | ... | ... |

### Domain

| TC ID | 테스트 케이스 | 예상 결과 |
|---|---|---|
| TC-REG-D-001 | ... | ... |
```

---

## 공통 주의사항

1. 원문에 없는 규칙을 추가했다면 반드시 "(원문 미명시)" 표기
2. 인증, 공통 헤더 등 여러 기능에 걸치는 규칙은 "공통" 항목으로 별도 정리
3. 각 단계 완료 후 사용자에게 검토를 요청하고, 확인 후 다음 단계로 진행
4. 모호한 요구사항이 발견되면 해당 항목에 "(정의 필요)" 표기하고 사용자에게 질문
