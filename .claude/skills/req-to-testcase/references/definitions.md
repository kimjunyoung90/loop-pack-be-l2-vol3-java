# 용어 정의 및 분류 기준

요구사항 분석 시 사용하는 핵심 용어의 정의와 분류 기준을 정리한다.

---

## 핵심 용어 계층

```
비즈니스 정책 (Business Policy)  ← Why: 왜 이 규칙이 존재하는가
    └── 비즈니스 규칙 (Business Rule)  ← What: 어떤 조건을 만족해야 하는가
         └── 비즈니스 로직 (Business Logic)  ← How: 코드로 어떻게 구현하는가
```

### 비즈니스 정책 (Business Policy)

- 서비스의 방향성이나 원칙을 선언한 것
- 구체적인 구현 방법을 포함하지 않음
- 주로 기획자, PO, 법무팀 등이 결정
- 예시: "회원의 개인정보는 보호되어야 한다", "하나의 계정은 한 사람만 소유할 수 있다"

### 비즈니스 규칙 (Business Rule)

- 정책을 실현하기 위한 구체적인 조건
- 기획서나 요구사항 문서에 명시되는 수준
- 주로 다른 필드, DB 조회 등 외부 상태와의 비교가 필요
- 예시: "이미 가입된 ID로는 가입할 수 없다", "이름의 마지막 글자를 *로 마스킹한다"

### 비즈니스 로직 (Business Logic)

- 규칙을 코드로 구현한 것
- 개발자가 작성하는 영역
- 예시: `if (memberRepository.existsByLoginId(loginId)) throw new DuplicateException();`

---

## 검증 규칙 (Validation Rule)

- 입력값 자체가 올바른 형식인지 확인하는 규칙
- 도메인 지식 없이, 데이터만 보고 판단 가능
- 단일 필드만 보고 통과 여부를 판단할 수 있는 경우가 많음
- 어떤 서비스든 범용적으로 적용 가능
- 예시: "이메일에 @가 포함되어야 한다", "비밀번호는 8~16자여야 한다"

---

## 비즈니스 규칙 vs 검증 규칙 판단 기준

| 판단 질문 | Yes → | No → |
|---|---|---|
| 이 필드 하나만 보고 판단할 수 있는가? | 검증 규칙 가능성 높음 | 비즈니스 규칙 가능성 높음 |
| 다른 서비스에 그대로 가져가도 성립하는가? | 검증 규칙 | 비즈니스 규칙 |
| DB 조회나 다른 필드와의 비교가 필요한가? | 비즈니스 규칙 | 검증 규칙 가능성 높음 |

### 경계 사례 처리

검증 규칙의 **배경**이 보안 정책이더라도, 규칙 자체의 성격이 포맷 검증이면 검증 규칙으로 분류한다.

- "비밀번호 8자 이상" → 보안 정책이 동기이지만, 필드 하나로 판단 가능 → **검증 규칙**
- "비밀번호에 생년월일 포함 불가" → 다른 필드(생년월일)와 비교 필요 → **비즈니스 규칙**

---

## 레이어별 책임 정의

### Controller

- 요청/응답 처리 (HTTP 요청 파싱, 응답 변환)
- 입력값 포맷 검증 (검증 규칙 담당)
- 헤더 파싱
- 요청 라우팅

### Service

- 비즈니스 흐름 조율
- 외부 상태와의 비교가 필요한 비즈니스 규칙 (DB 조회, 외부 API 호출 등)
- 트랜잭션 관리
- 외부 모듈 의존 처리 (암호화 등)

### Domain

- 엔티티 자체의 규칙
- 자기 상태(필드)만으로 판단 가능한 비즈니스 규칙
- 외부 의존 없음

### 배치 판단 기준

규칙의 책임은 **판단의 주체**가 되는 레이어에 둔다. 판단에 필요한 데이터를 제공하는 레이어와 판단을 내리는 레이어는 다를 수 있다.

- 예: "이미 가입된 ID로 가입 불가" → Service가 판단하지만, 중복 여부 데이터는 Repository(Persistence)가 제공
